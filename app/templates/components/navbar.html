<nav class="fixed top-0 left-0 w-full z-50 bg-gray-900 text-white shadow-lg">
  <div class="container mx-auto px-4 py-4 flex justify-between items-center flex-wrap">
    <!-- Logo -->
    <div class="flex items-center space-x-2">
      <picture class="block">
        <source srcset="{{ url_for('static', filename='img/logo2-260.webp') }}" type="image/webp">
        <img src="{{ url_for('static', filename='img/logo2.png') }}" alt="Logo Barbería" width="160" height="160" class="h-10 w-auto object-contain" loading="lazy">
      </picture>
      <a href="/" class="text-2xl font-bold tracking-wider">RG4L<span class="text-rose-600">BARBER</span></a>
    </div>

    <!-- Botón hamburguesa -->
    <button id="menu-btn" type="button" class="md:hidden focus:outline-none z-[70] relative" aria-controls="mobile-menu" aria-expanded="false" aria-label="Abrir menú de navegación">
      <div id="bar1" class="w-6 h-0.5 bg-white mb-1 transition-all duration-300 origin-center"></div>
      <div id="bar2" class="w-6 h-0.5 bg-white mb-1 transition-all duration-300"></div>
      <div id="bar3" class="w-6 h-0.5 bg-white transition-all duration-300 origin-center"></div>
    </button>

    {% set home_url = url_for('auth.index') %}

    <!-- Menú escritorio -->
    <div class="hidden md:flex space-x-6 items-center mt-2 md:mt-0 w-full md:w-auto">
      {% for link in ['inicio', 'servicios', 'galeria', 'equipo', 'contacto'] %}
        <a href="{{ home_url }}#{{ link }}" class="relative group capitalize">
          <span class="text-white group-hover:text-rose-500">{{ link }}</span>
          <span class="absolute left-0 bottom-0 w-0 group-hover:w-full h-0.5 bg-rose-500 transition-all duration-300"></span>
        </a>
      {% endfor %}

      {% if session['usuario_id'] %}
        <!-- Dropdown -->
        <div class="relative">
          <div class="group">
            <button class="flex items-center gap-2 text-white hover:text-rose-500">
              <!-- Reemplazar icono genérico con foto de perfil o iniciales -->
              <div class="navbar-avatar w-8 h-8 bg-black rounded-full flex items-center justify-center text-white text-sm font-bold relative">
                {{ session['nombre'][0] }}{{ session['apellido'][0] }}
                <span class="absolute -top-0.5 -right-0.5 bg-rose-600 text-white text-[10px] rounded-full px-1 hidden" id="notif-count-avatar">0</span>
              </div>
            </button>
            <div class="absolute right-0 mt-[18px] w-64 bg-gray-800 border border-gray-700 rounded shadow-lg opacity-0 group-hover:opacity-100 invisible group-hover:visible transition-all duration-200 z-50">
              <!-- Añadir enlace al perfil en la información del usuario -->
              <a href="/perfil" class="flex items-center gap-3 px-4 py-3 border-b border-gray-700 hover:bg-gray-700">
                <div class="navbar-avatar w-10 h-10 bg-black rounded-full flex items-center justify-center text-white text-sm font-bold">
                  {{ session['nombre'][0] }}{{ session['apellido'][0] }}
                </div>
                <div>
                  <p class="font-semibold">{{ session['nombre'] }} {{ session['apellido'] }}</p>
                  <p class="text-xs text-gray-400">{{ session['correo'] }}</p>
                </div>
              </a>
              <div class="py-2 border-b border-gray-700 space-y-1">
                {% if session['rol'] == 'admin' %}
                  <a href="/dashboard" class="flex items-center gap-2 px-4 py-2 text-sm hover:bg-gray-700">
                    <i class="fas fa-tools text-gray-400"></i> Panel Admin
                  </a>
                  <a href="/notificaciones" class="flex items-center gap-2 px-4 py-2 text-sm hover:bg-gray-700">
                    <i class="fas fa-bell text-gray-400"></i> Notificaciones
                    <span id="notif-count-menu" class="ml-auto inline-flex items-center justify-center bg-rose-600 text-white text-[10px] font-bold rounded-full px-1.5 py-0.5 hidden">0</span>
                  </a>
                {% else %}
                  <a href="/dashboard" class="flex items-center gap-2 px-4 py-2 text-sm hover:bg-gray-700">
                    <i class="fas fa-calendar-check text-gray-400"></i> Mis Citas
                  </a>
                  <a href="/notificaciones" class="flex items-center gap-2 px-4 py-2 text-sm hover:bg-gray-700">
                    <i class="fas fa-bell text-gray-400"></i> Notificaciones
                    <span id="notif-count-menu" class="ml-auto inline-flex items-center justify-center bg-rose-600 text-white text-[10px] font-bold rounded-full px-1.5 py-0.5 hidden">0</span>
                  </a>
                {% endif %}
              </div>
              <div class="py-2">
                <a href="/logout" class="flex items-center gap-2 px-4 py-2 text-sm text-red-400 hover:bg-gray-700">
                  <i class="fas fa-sign-out-alt"></i> Cerrar sesión
                </a>
              </div>
            </div>
            <div class="absolute -bottom-2 right-0 h-3 w-64 pointer-events-none"></div>
          </div>
        </div>
      {% else %}
        <a href="/login" class="bg-gray-700 hover:bg-gray-600 px-3 py-2 rounded-md text-white text-sm">Iniciar Sesión</a>
        <a href="/register" class="bg-rose-600 hover:bg-rose-700 px-3 py-2 rounded-md text-white text-sm ml-2">Registrarse</a>
      {% endif %}
    </div>
  </div>

  <!-- Overlay -->
  <div id="mobile-overlay" class="fixed inset-0 bg-black/50 backdrop-blur-sm z-40 hidden md:hidden"></div>

  <!-- Menú móvil -->
  <div id="mobile-menu" class="fixed top-0 right-0 w-72 h-full bg-gray-900 transform translate-x-full transition-transform duration-300 ease-in-out z-50 md:hidden pt-8 px-6 flex flex-col">
    {% if session['usuario_id'] %}
      <div class="mt-6 mb-3 border-b border-gray-700 py-2">
        <!-- Añadir enlace al perfil en versión móvil -->
        <a href="/perfil" class="flex items-center gap-3 hover:bg-gray-800 rounded-md px-3 py-2">
          <div class="navbar-avatar w-10 h-10 bg-black rounded-full flex items-center justify-center text-white text-sm font-bold">
            {{ session['nombre'][0] }}{{ session['apellido'][0] }}
          </div>
          <div>
            <p class="font-semibold text-white">{{ session['nombre'] }} {{ session['apellido'] }}</p>
            <p class="text-xs text-gray-400">{{ session['correo'] }}</p>
          </div>
        </a>
      </div>
    {% else %}
      <div class="mt-6 mb-3 space-y-2 border-b border-gray-700 py-4">
        <a href="/login" class="block bg-gray-700 hover:bg-gray-600 px-4 py-2 rounded-md text-white text-center">Iniciar Sesión</a>
        <a href="/register" class="block bg-rose-600 hover:bg-rose-700 px-4 py-2 rounded-md text-white text-center">Registrarse</a>
      </div>
    {% endif %}

    <div class="space-y-1 border-b border-gray-700 py-2">
      {% for link in ['inicio', 'servicios', 'galeria', 'equipo', 'contacto'] %}
        <a href="{{ home_url }}#{{ link }}" class="block text-white hover:bg-gray-800 rounded-md px-3 py-2 transition">{{ link|capitalize }}</a>
      {% endfor %}
    </div>

    {% if session['usuario_id'] %}
      <div class="space-y-1 border-b border-gray-700 py-2">
        {% if session['rol'] == 'admin' %}
          <a href="/dashboard" class="flex items-center gap-2 text-white hover:bg-gray-800 px-3 py-2 rounded-md">
            <i class="fas fa-tools"></i> Panel Admin
          </a>
          <a href="/notificaciones" class="flex items-center gap-2 text-white hover:bg-gray-800 px-3 py-2 rounded-md">
            <i class="fas fa-bell"></i> Notificaciones
            <span id="notif-count-mobile" class="ml-auto inline-flex items-center justify-center bg-rose-600 text-white text-[10px] font-bold rounded-full px-1.5 py-0.5 hidden">0</span>
          </a>
        {% else %}
          <a href="/dashboard" class="flex items-center gap-2 text-white hover:bg-gray-800 px-3 py-2 rounded-md">
            <i class="fas fa-calendar-check"></i> Mis Citas
          </a>
          <a href="/notificaciones" class="flex items-center gap-2 text-white hover:bg-gray-800 px-3 py-2 rounded-md">
            <i class="fas fa-bell"></i> Notificaciones
            <span id="notif-count-mobile" class="ml-auto inline-flex items-center justify-center bg-rose-600 text-white text-[10px] font-bold rounded-full px-1.5 py-0.5 hidden">0</span>
          </a>
        {% endif %}
      </div>
      <div class="pt-2 border-t border-gray-700">
        <a href="/logout" class="flex items-center gap-2 text-red-400 hover:text-red-300 px-3 py-2">
          <i class="fas fa-sign-out-alt"></i> Cerrar sesión
        </a>
      </div>
    {% endif %}
  </div>
</nav>
